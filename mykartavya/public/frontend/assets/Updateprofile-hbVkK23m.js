var f=(C,p,d)=>new Promise((g,s)=>{var u=c=>{try{b(d.next(c))}catch(v){s(v)}},h=c=>{try{b(d.throw(c))}catch(v){s(v)}},b=c=>c.done?g(c.value):Promise.resolve(c.value).then(u,h);b((d=d.apply(C,p)).next())});import{r as y,A as S,j as H,c as l,b as t,u as _,i as D,t as m,n as $,F as q,g as P,k as x,s as w,v as V,m as O,o as n,f as z,B as L,C as J}from"./index-Bz-WKddl.js";import{_ as R}from"./Rectangle-Cxb5RPqE.js";import{l as k}from"./index-BqFlHXaT.js";const G={class:"max-w-[1920px] mx-auto px-10 pt-[82px] pb-4 bg-gray-50"},K={class:"h-[261px] rounded-b-md bg-white"},Q={class:"relative"},W={class:"absolute left-8 -bottom-8"},X={class:"w-32 h-32 rounded-full border-4 border-white overflow-hidden"},Y=["src"],Z={key:1,class:"w-full h-full bg-gray-200 flex items-center justify-center text-[40px] text-gray-600"},ee={class:"pt-10 px-4"},te={class:"text-3xl font-medium"},oe={class:"text-bodyh1 text-gray-600 mt-1"},ae={class:"bg-white rounded-lg shadow mt-4 p-6"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},re={class:"block text-bodyh1 font-normal text-gray-700 mb-1"},le={key:0,class:"text-red-500 pt-2"},ne=["onUpdate:modelValue","type","placeholder"],ue=["onUpdate:modelValue"],ie={value:"",disabled:""},de=["value"],ce={key:2,class:"text-red-500 text-sm mt-1"},me={key:0,class:"text-red-500 text-sm mt-1"},pe={key:0,class:"text-red-500 text-sm mt-1"},_e={__name:"Updateprofile",setup(C){const p=D("call"),d=D("auth");O();const g=y({first_name:{label:"First Name",type:"text",placeholder:"Enter your first name",required:!0},last_name:{label:"Last Name",type:"text",placeholder:"Enter your last name",required:!0},mobile_number:{label:"Phone No.",type:"text",placeholder:"Enter phone number",required:!0,pattern:/^[0-9]{10}$/,error_message:"Please enter a valid 10-digit phone number"},custom_country:{label:"Country",type:"select",required:!0},custom_state:{label:"State",type:"select",required:!0},custom_city:{label:"City",type:"select",required:!0},custom_company:{label:"Company",type:"select",required:!1},custom_date_of_birth:{label:"Date of Birth",type:"date",required:!0,min:"1900-01-01",max:new Date().toISOString().split("T")[0],error_message:"Please select a valid date of birth"},title:{label:"Title",type:"text",placeholder:"Enter your title",required:!1}}),s=y({first_name:"",last_name:"",mobile_number:"",custom_country:"",custom_state:"",custom_city:"",custom_company:"",custom_date_of_birth:"",title:""}),u=y({}),h=y([]),b=y([]),c=y([]),v=y([]),j=()=>f(this,null,function*(){const o=yield p("mykartavya.controllers.api.country_data");h.value=o||[]}),M=()=>f(this,null,function*(){if(!s.value.custom_country)return;const o=yield p("mykartavya.controllers.api.state_data",{country:s.value.custom_country});b.value=o||[]}),B=()=>f(this,null,function*(){if(!s.value.custom_state)return;const o=yield p("mykartavya.controllers.api.city_data",{state:s.value.custom_state});c.value=o||[]}),U=()=>f(this,null,function*(){const o=yield p("mykartavya.controllers.api.company_data");v.value=o||[]});S(()=>s.value.custom_country,M),S(()=>s.value.custom_state,B);const E=()=>f(this,null,function*(){let o=yield p("mykartavya.controllers.api.sva_user_data");o&&o.length>0&&(s.value=o[0])}),N=()=>{u.value={};let o=!0;for(const e in s.value){const a=g.value[e],r=s.value[e];if(a&&(a.required&&!r&&(u.value[e]=`${a.label} is required.`,o=!1),e==="mobile_number"&&a.pattern&&!a.pattern.test(r)&&(u.value[e]=a.error_message,o=!1),e==="custom_date_of_birth"&&a.min&&r)){const i=new Date(r),F=new Date(a.min),T=new Date(a.max);(i<F||i>T)&&(u.value[e]=a.error_message,o=!1)}}return o},A=()=>f(this,null,function*(){if(N())try{let o=yield p("mykartavya.controllers.api.update_sva_user",{data:JSON.stringify(s.value)});o.success?k.success("Profile updated successfully!"):k.error(o.message||"Failed to update profile.")}catch(o){k.error("An error occurred while updating the profile.")}}),I=o=>{switch(o){case"custom_country":return h.value.map(e=>({name:e.name,label:e.label||e.name}));case"custom_state":return b.value.map(e=>({name:e.name,label:e.state_name||e.name}));case"custom_city":return c.value.map(e=>({name:e.name,label:e.district_name||e.name}));case"custom_company":return v.value.map(e=>({name:e.name,label:e.company_name||e.name}));default:return[]}};return H(()=>{j(),U(),E()}),(o,e)=>(n(),l("div",G,[t("div",K,[t("div",Q,[e[6]||(e[6]=t("div",{class:"w-full h-[152px]"},[t("img",{src:R,alt:"Banner",class:"w-full h-full object-cover"})],-1)),t("div",W,[t("div",X,[_(d).user_image?(n(),l("img",{key:0,src:_(d).user_image,alt:"Profile",class:"w-full h-full object-cover"},null,8,Y)):(n(),l("div",Z,m(_(d).cookie.full_name.charAt(0)),1))])])]),t("div",ee,[t("h1",te,m(_(d).cookie.full_name),1),t("p",oe,m(_(d).cookie.user_id),1)])]),t("div",ae,[e[16]||(e[16]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4"},"Personal Info",-1)),t("form",{onSubmit:$(A,["prevent"])},[t("div",se,[(n(!0),l(q,null,P(g.value,(a,r)=>(n(),l("div",{key:r},[t("label",re,[z(m(a.label)+" ",1),a.required?(n(),l("span",le,"*")):w("",!0)]),a.type!=="select"?x((n(),l("input",{key:0,"onUpdate:modelValue":i=>s.value[r]=i,type:a.type,placeholder:a.placeholder,class:"block w-full border border-gray-300 text-bodyh2 rounded py-2 px-3 focus:outline-none focus:ring focus:ring-orange-200"},null,8,ne)),[[L,s.value[r]]]):x((n(),l("select",{key:1,"onUpdate:modelValue":i=>s.value[r]=i,class:"block w-full border border-gray-300 text-bodyh2 rounded py-2 px-3 focus:outline-none focus:ring focus:ring-orange-200"},[t("option",ie,"Select "+m(a.label),1),(n(!0),l(q,null,P(I(r),i=>(n(),l("option",{key:i.name,value:i.name},m(i.label||i.name),9,de))),128))],8,ue)),[[J,s.value[r]]]),u.value[r]?(n(),l("p",ce,m(u.value[r]),1)):w("",!0)]))),128)),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-bodyh1 font-normal text-gray-700 mb-1"},"Password",-1)),x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.password=a),type:"password",placeholder:"Enter your password",class:"block w-full border border-gray-300 text-bodyh2 rounded py-2 px-3 focus:outline-none focus:ring focus:ring-orange-200"},null,512),[[V,s.value.password]]),u.value.password?(n(),l("p",me,m(u.value.password),1)):w("",!0)]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-bodyh1 font-normal text-gray-700 mb-1"},"Confirm Password",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.confirm_password=a),type:"password",placeholder:"Confirm your password",class:"block w-full border border-gray-300 text-bodyh2 rounded py-2 px-3 focus:outline-none focus:ring focus:ring-orange-200"},null,512),[[V,s.value.confirm_password]]),u.value.confirm_password?(n(),l("p",pe,m(u.value.confirm_password),1)):w("",!0)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-bodyh1 font-normal text-gray-700 mb-1"},"Add CV",-1)),t("div",{class:"flex flex-col items-center justify-center border-2 border-dashed border-orange-300 text-orange-500 p-4 rounded cursor-pointer",onClick:e[3]||(e[3]=a=>o.cvInput.click())},[e[9]||(e[9]=t("svg",{class:"w-10 h-10 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 3h10M7 3a2 2 0 00-2 2v2m2-2h10m0 0a2 2 0 012 2v2m-2-2H7m13 8V8H4v8a2 2 0 002 2h12a2 2 0 002-2z"})],-1)),e[10]||(e[10]=t("span",{class:"text-bodyh1"},"Click to upload or drag and drop",-1)),t("input",{ref:"cvInput",type:"file",accept:".pdf,.doc,.docx",class:"hidden",onChange:e[2]||(e[2]=(...a)=>o.onCvSelected&&o.onCvSelected(...a))},null,544)])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-bodyh1 font-normal text-gray-700 mb-1"},"Add Portfolio",-1)),t("div",{class:"flex flex-col items-center justify-center border-2 border-dashed border-orange-300 text-orange-500 p-4 rounded cursor-pointer",onClick:e[5]||(e[5]=a=>o.portfolioInput.click())},[e[12]||(e[12]=t("svg",{class:"w-10 h-10 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 3h10M7 3a2 2 0 00-2 2v2m2-2h10m0 0a2 2 0 012 2v2m-2-2H7m13 8V8H4v8a2 2 0 002 2h12a2 2 0 002-2z"})],-1)),e[13]||(e[13]=t("span",{class:"text-sm"},"Click to upload or drag and drop",-1)),t("input",{ref:"portfolioInput",type:"file",accept:".pdf,.doc,.docx",class:"hidden",onChange:e[4]||(e[4]=(...a)=>o.onPortfolioSelected&&o.onPortfolioSelected(...a))},null,544)])])]),e[15]||(e[15]=t("div",{class:"mt-6"},[t("button",{type:"submit",class:"bg-orange-500 text-white font-semibold py-2 px-4 rounded hover:bg-orange-600 transition"}," UPDATE ")],-1))],32)])]))}};export{_e as default};
