var pe=Object.defineProperty,ve=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var X=(m,d,n)=>d in m?pe(m,d,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[d]=n,Z=(m,d)=>{for(var n in d||(d={}))he.call(d,n)&&X(m,n,d[n]);if(Q)for(var n of Q(d))ge.call(d,n)&&X(m,n,d[n]);return m},ee=(m,d)=>ve(m,me(d));var M=(m,d,n)=>new Promise((k,o)=>{var E=g=>{try{C(n.next(g))}catch($){o($)}},i=g=>{try{C(n.throw(g))}catch($){o($)}},C=g=>g.done?k(g.value):Promise.resolve(g.value).then(E,i);C((n=n.apply(m,d)).next())});import{_ as fe,r as x,o as te,A as we,l as ye,k as xe,C as _e,c as v,m as se,a as e,e as be,t as _,u as b,i as oe,z as ke,F as U,h as D,b as h,g as ae,B as Ce,j as u,p as re}from"./index-DAavycbD.js";import{_ as le,C as ne}from"./NotFound-B7NMzcMx.js";import{C as N}from"./CardLoader-Cfyoa6Rd.js";import{F as $e,T as Me,L as Le,M as je}from"./twitter-B5YkquAB.js";const Se={class:"min-h-screen bg-gray-100"},Ae={key:0,class:"w-full bg-orange-100"},Ve={class:"max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 py-8 mt-10"},Ee={class:"grid grid-cols-1 lg:grid-cols-12 gap-8"},Oe={class:"lg:col-span-4"},Re={class:"bg-white rounded-md overflow-hidden"},Be={class:"relative h-64 overflow-hidden"},Fe=["src"],Ie={class:"absolute bottom-0 left-0 p-4"},Ne={class:"text-2xl font-bold text-white"},ze={class:"inline-block bg-orange-500 text-white px-2 py-1 rounded text-sm mt-2"},Ue={class:"p-6"},De={class:"flex items-center gap-4 mb-4"},Te={class:"flex items-center gap-2"},We={class:"text-gray-700"},He={class:"flex items-center gap-2"},Pe={class:"text-gray-700"},Ge={class:"flex items-center gap-2 mb-6"},Je={class:"text-gray-700"},Ye={class:"mb-6"},qe={class:"w-full bg-gray-200 rounded-full h-2"},Ke={class:"flex items-center justify-between mt-2 text-sm text-gray-600"},Qe={class:"mb-6"},Xe={class:"flex flex-wrap gap-2"},Ze=["src"],et={key:1,class:"text-sm text-gray-700"},tt={class:"bg-white rounded-md mt-6 p-6 h-[600px] flex flex-col sticky top-20"},st={class:"flex-1 overflow-y-auto pr-2 custom-scrollbar"},ot={class:"prose prose-sm max-w-none"},at=["innerHTML"],rt={class:"mt-4 pt-4 border-t border-gray-200"},lt={class:"flex items-center gap-3"},nt={class:"lg:col-span-8"},it={key:0,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-2 pt-1 gap-4"},ct={key:1},dt={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},ut={key:1,class:"w-full h-[300px]"},pt={class:"mt-12"},vt={class:"flex items-center justify-between mb-6"},mt={class:"flex items-center gap-2"},ht=["disabled"],gt=["disabled"],ft={key:0,class:"flex gap-4 pb-4 overflow-x-auto scrollbar-hide"},wt={key:1,class:"w-full h-[300px]"},yt=450,xt={__name:"Opportunities",setup(m){const d=Ce(),n=oe("call"),k=x([]),o=we(),E=oe("formatDate"),i=x(null),C=x(!0),g=x(!1),$=x(!1),y=x([]),O=x([]),r=x({}),L=x(!0),T=()=>M(this,null,function*(){var s,t;console.log(k.value,"activities?.value?.sdgs",o==null?void 0:o.params);try{let a=(s=k==null?void 0:k.value)==null?void 0:s.sdgs;typeof a=="string"&&(a=JSON.parse(a));let f={sdgs:a==null?void 0:a.map(c=>c.sdgs_name)};const p=yield n("mykartavya.controllers.api.related_opportunities",{filter:f});p&&p.length>0&&((t=o==null?void 0:o.params)!=null&&t.name?(O.value=p.filter(c=>{var w;return c.name!==((w=o==null?void 0:o.params)==null?void 0:w.name)}),r.value=p.find(c=>{var w;return c.name===((w=o==null?void 0:o.params)==null?void 0:w.name)})):(O.value=p,r.value=p[0]))}catch(a){console.error("Error fetching activity data:",a)}}),ie=()=>M(this,null,function*(){var s;try{const t=yield n("mykartavya.controllers.api.sva_user_data");t&&t.length>0&&($.value=((s=t[0])==null?void 0:s.workflow_state)==="Approved")}catch(t){console.error("Error checking user approval status:",t)}}),W=()=>M(this,null,function*(){var s,t;try{if(!((s=o==null?void 0:o.params)!=null&&s.name)){y.value=[];return}const a=yield n("mykartavya.controllers.api.get_opportunity_activity",{opportunity:(t=o==null?void 0:o.params)==null?void 0:t.name,filter:{sdgs:k.value.sdgs}}).catch(f=>(console.error("API Error:",f),null));if(!a){console.warn("No response from get_opportunity_activity API"),y.value=[];return}if(Array.isArray(a)){const f=a.map(p=>{var c;return ee(Z({},p),{activity:p.activity,name:(c=o==null?void 0:o.params)==null?void 0:c.name})});y.value=f}else console.warn("Invalid response format from get_opportunity_activity API"),y.value=[]}catch(a){console.error("Error in opportunitiesActivity:",a),y.value=[]}}),ce=s=>{s.name!==o.params.name&&d.push(`/opportunities/${s.name}`)};te(()=>M(this,null,function*(){L.value=!0;try{if(yield ie(),yield T(),o.params.name)try{yield W()}catch(s){console.warn("Failed to load activities on mount:",s),y.value=[]}}catch(s){console.error("Error in onMounted:",s)}finally{L.value=!1}})),ye(()=>o.params.name,s=>M(this,null,function*(){if(s){L.value=!0;try{yield T();try{yield W()}catch(t){console.warn("Failed to load activities:",t),y.value=[]}}catch(t){console.error("Error updating opportunity:",t)}finally{L.value=!1}}else y.value=[]}),{immediate:!1});const H=yt,de=()=>{i.value&&i.value.scrollTo({left:Math.max(0,i.value.scrollLeft-H),behavior:"smooth"})},ue=()=>{if(i.value){const s=i.value.scrollWidth-i.value.clientWidth;i.value.scrollTo({left:Math.min(s,i.value.scrollLeft+H),behavior:"smooth"})}},z=()=>{if(!i.value)return;const{scrollLeft:s,scrollWidth:t,clientWidth:a}=i.value;C.value=s<=0;const f=t>a;g.value=!f||s+a>=t};xe(()=>{i.value&&(i.value.addEventListener("scroll",z),z())}),te(()=>{const s=new ResizeObserver(()=>{z()});i.value&&s.observe(i.value),_e(()=>{s.disconnect()})}),window.addEventListener("resize",()=>{});const R=s=>{var S,A;const t=encodeURIComponent(window.location.href),a=encodeURIComponent(((S=r.value)==null?void 0:S.activity_name)||""),p=((A=r.value)!=null&&A.sdgs?JSON.parse(r.value.sdgs):[]).map(I=>{var V;return(V=I.sdgs_name)==null?void 0:V.replace(/\s+/g,"")}).join(",");let c="";switch(s){case"facebook":c=`https://www.facebook.com/sharer/sharer.php?u=${t}&quote=${a}`;break;case"twitter":c=`https://twitter.com/intent/tweet?url=${t}&text=${encodeURIComponent(`Check out ${a}`)}&hashtags=${p}`;break;case"linkedin":c=`https://www.linkedin.com/sharing/share-offsite/?url=${t}`;break;case"whatsapp":c=`https://wa.me/?text=${encodeURIComponent(`${a}
${window.location.href}`)}`;break}const w=600,j=400,B=(window.innerWidth-w)/2,F=(window.innerHeight-j)/2;window.open(c,"social-share",`width=${w},height=${j},left=${B},top=${F}`)};return(s,t)=>{var a,f,p,c,w,j,B,F,S,A,I,V,P,G,J,Y,q;return u(),v("div",Se,[$.value?se("",!0):(u(),v("div",Ae,t[6]||(t[6]=[be('<div class="max-w-[1920px] mx-auto py-3 px-4 sm:px-6 lg:px-8" data-v-78e58902><div class="flex items-center justify-between flex-wrap" data-v-78e58902><div class="w-0 flex-1 flex items-center" data-v-78e58902><span class="flex p-2 rounded-lg bg-white/20" data-v-78e58902><svg class="h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-78e58902><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-78e58902></path></svg></span><p class="ml-3 font-medium text-white" data-v-78e58902><span class="md:hidden" data-v-78e58902>Your account is pending approval</span><span class="hidden md:inline" data-v-78e58902>Your account is currently pending approval. Some features may be limited until your account is approved.</span></p></div><div class="order-3 mt-2 flex-shrink-0 w-full sm:order-2 sm:mt-0 sm:w-auto" data-v-78e58902><a href="/profile" class="flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-yellow-600 bg-white hover:bg-white/90 transition-all duration-300" data-v-78e58902> View Profile </a></div></div></div>',1)]))),e("div",Ve,[e("div",Ee,[e("div",Oe,[e("div",Re,[e("div",Be,[e("img",{src:(a=r.value)==null?void 0:a.activity_image,class:"w-full h-full object-cover",alt:"Opportunity Image"},null,8,Fe),t[7]||(t[7]=e("div",{class:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"},null,-1)),e("div",Ie,[e("h1",Ne,_((f=r.value)==null?void 0:f.activity_name),1),e("span",ze,_((p=r.value)==null?void 0:p.types),1)])]),e("div",Ue,[e("div",De,[e("div",Te,[t[8]||(t[8]=e("svg",{class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("span",We,_(b(E)((c=r.value)==null?void 0:c.start_date))+" - "+_(b(E)((w=r.value)==null?void 0:w.end_date)),1)]),e("div",He,[t[9]||(t[9]=e("svg",{class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Pe,_((B=(j=r.value)==null?void 0:j.hours)!=null?B:"0")+" hr",1)])]),e("div",Ge,[t[10]||(t[10]=e("svg",{class:"w-5 h-5 text-orange-500",viewBox:"0 0 16 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M15.5002 3.66602C15.5002 2.28518 12.8885 1.16602 9.66683 1.16602C6.44516 1.16602 3.8335 2.28518 3.8335 3.66602M15.5002 3.66602V6.99935C15.5002 7.84935 14.5118 8.59935 13.0002 9.05102C12.0552 9.33435 10.906 9.49935 9.66683 9.49935C8.42766 9.49935 7.2785 9.33352 6.3335 9.05102C4.82266 8.59935 3.8335 7.84935 3.8335 6.99935V3.66602M15.5002 3.66602C15.5002 4.51602 14.5118 5.26602 13.0002 5.71768C12.0552 6.00102 10.906 6.16602 9.66683 6.16602C8.42766 6.16602 7.2785 6.00018 6.3335 5.71768C4.82266 5.26602 3.8335 4.51602 3.8335 3.66602",stroke:"#FF5722","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M0.5 6.9994V10.3327C0.5 11.1827 1.48917 11.9327 3 12.3844C3.945 12.6677 5.09417 12.8327 6.33333 12.8327C7.5725 12.8327 8.72167 12.6669 9.66667 12.3844C11.1775 11.9327 12.1667 11.1827 12.1667 10.3327V9.4994M0.5 6.9994C0.5 6.0019 1.8625 5.14107 3.83333 4.74023M0.5 6.9994C0.5 7.8494 1.48917 8.5994 3 9.05107C3.945 9.3344 5.09417 9.4994 6.33333 9.4994C6.9125 9.4994 7.47167 9.46357 8 9.39607",stroke:"#FF5722","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("span",Je,_((S=(F=r.value)==null?void 0:F.karma_points)==null?void 0:S.toLocaleString())+" Points",1)]),e("div",Ye,[e("div",qe,[e("div",{class:"bg-green-500 h-2 rounded-full",style:ke(`width: ${(I=(A=r.value)==null?void 0:A.com_percent)!=null?I:0}%`)},null,4)]),e("div",Ke,[e("span",null,_(((V=r.value)==null?void 0:V.com_percent)!=null?r.value.com_percent:0)+"% completed",1),e("span",null,_(((P=r.value)==null?void 0:P.donet_hours)!=null?(r.value.donet_hours/60/60).toFixed(2):"0")+" hr",1)])]),e("div",Qe,[t[11]||(t[11]=e("h3",{class:"text-lg font-medium text-gray-800 mb-3"},"SDG Goals",-1)),e("div",Xe,[(G=r.value)!=null&&G.sdgs?(u(!0),v(U,{key:0},D(JSON.parse(r.value.sdgs),(l,K)=>(u(),v("div",{key:K,class:"bg-gray-100 p-2 rounded-lg flex items-center gap-2 hover:bg-gray-200 transition-all duration-300"},[l!=null&&l.image?(u(),v("img",{key:0,src:l.image,alt:"SDG Icon",class:"w-6 h-6"},null,8,Ze)):(u(),v("span",et,_(l==null?void 0:l.sdgs_name),1))]))),128)):se("",!0)])]),t[12]||(t[12]=e("button",{class:"w-fit bg-orange-500 hover:bg-orange-600 text-white py-2 px-4 rounded-sm font-medium transition-all duration-300 flex items-center justify-start gap-2"},[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})]),e("span",{class:"text-sm"},"Act Now")],-1))])]),e("div",tt,[t[14]||(t[14]=e("h2",{class:"text-lg font-medium mb-4"},"Volunteer Role",-1)),e("div",st,[e("div",ot,[e("p",{class:"text-gray-600 whitespace-pre-wrap",innerHTML:(J=r.value)==null?void 0:J.activity_description},null,8,at)])]),e("div",rt,[t[13]||(t[13]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Share this opportunity",-1)),e("div",lt,[e("button",{onClick:t[0]||(t[0]=l=>R("facebook")),class:"p-2 rounded-full border border-gray-300 text-gray-500 hover:bg-gray-50 transition-all duration-300"},[h(b($e),{class:"w-5 h-5"})]),e("button",{onClick:t[1]||(t[1]=l=>R("twitter")),class:"p-2 rounded-full border border-gray-300 text-gray-500 hover:bg-gray-50 transition-all duration-300"},[h(b(Me),{class:"w-5 h-5"})]),e("button",{onClick:t[2]||(t[2]=l=>R("linkedin")),class:"p-2 rounded-full border border-gray-300 text-gray-500 hover:bg-gray-50 transition-all duration-300"},[h(b(Le),{class:"w-5 h-5"})]),e("button",{onClick:t[3]||(t[3]=l=>R("whatsapp")),class:"p-2 rounded-full border border-gray-300 text-gray-500 hover:bg-gray-50 transition-all duration-300"},[h(b(je),{class:"w-5 h-5"})])])])])]),e("div",nt,[t[16]||(t[16]=e("h2",{class:"text-lg font-medium mb-6"},"Activities",-1)),L.value?(u(),v("div",it,[h(N),h(N),h(N),h(N)])):(u(),v("div",ct,[((Y=y.value)==null?void 0:Y.length)>0?(u(),v("div",dt,[(u(!0),v(U,null,D(y.value,l=>(u(),re(ne,{key:l.name,item:l,mode:"opportunity"},null,8,["item"]))),128))])):(u(),v("div",ut,[h(le)]))])),e("div",pt,[e("div",vt,[t[15]||(t[15]=e("h2",{class:"text-lg font-medium"},"Related Opportunities",-1)),e("div",mt,[e("button",{onClick:t[4]||(t[4]=l=>!C.value&&de),disabled:C.value,class:"p-3 rounded-xl hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300"},[h(b(ae),{name:"chevron-left",class:"w-6 h-6"})],8,ht),e("button",{onClick:t[5]||(t[5]=l=>!g.value&&ue),disabled:g.value,class:"p-3 rounded-xl hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300"},[h(b(ae),{name:"chevron-right",class:"w-6 h-6"})],8,gt)])]),e("div",{ref_key:"scrollContainer",ref:i,class:"relative"},[((q=O.value)==null?void 0:q.length)>0?(u(),v("div",ft,[(u(!0),v(U,null,D(O.value,l=>(u(),re(ne,{key:l.name,item:l,mode:"opportunity",onClick:K=>ce(l),class:"w-[280px] min-w-[280px] max-w-[280px] lg:w-[450px] lg:min-w-[450px] lg:max-w-[450px] transform hover:scale-105 transition-all duration-300 cursor-pointer"},null,8,["item","onClick"]))),128))])):(u(),v("div",wt,[h(le)]))],512)])])])])])}}},Mt=fe(xt,[["__scopeId","data-v-78e58902"]]);export{Mt as default};
