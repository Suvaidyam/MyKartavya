var m=(h,d,c)=>new Promise((p,i)=>{var n=s=>{try{t(c.next(s))}catch(o){i(o)}},u=s=>{try{t(c.throw(s))}catch(o){i(o)}},t=s=>s.done?p(s.value):Promise.resolve(s.value).then(n,u);t((c=c.apply(h,d)).next())});import{r as f,A as F,C as j,c as v,a,m as N,b,e as y,t as _,y as R,d as w,w as D,n as q,D as O,l as A,i as J,B as K,h as x}from"./index-xatQhOuB.js";import{_ as S,a as Y,b as E}from"./Frame (1)-BNHRP8Uf.js";import{l}from"./index-DLcwUBca.js";/* empty css              */const U={class:"pt-[62px] flex flex-col items-center min-h-screen bg-secondary",style:{background:"#F5F5F5"}},z={class:"flex flex-col items-center text-center w-full px-4 min-h-[calc(100vh-64px)] justify-center"},M={class:"bg-white p-6 mt-[36px] rounded-sm w-[443px] max-w-full"},W={class:"text-gray-600 text-center mt-1 text-[12px] font-normal"},G={class:"text-orange-500 font-semibold"},L={class:"flex justify-center space-x-2 mt-4"},Q={style:{display:"flex","flex-direction":"row"}},X={key:0,class:"h-5 w-5"},Z={key:1},$={class:"text-center text-[14px] text-gray-600 mt-4"},ee={key:0},le={__name:"Verifyotp",setup(h){const d=J("call"),c=K(),p=F(),i=f(!1),n=f(p.query.email||""),u=f(""),t=f(!1),s=f(30);let o=null;const C=()=>{t.value=!0,s.value=30,o=setInterval(()=>{s.value--,s.value<=0&&(clearInterval(o),t.value=!1)},1e3)},k=()=>m(this,null,function*(){if(!t.value)try{C(),yield P()}catch(r){t.value=!1,clearInterval(o)}});j(()=>{o&&clearInterval(o)});const P=()=>m(this,null,function*(){if(!n.value){l.error("Please enter an email",{autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0});return}try{(yield d("mykartavya.controllers.email.send_otp",{email:n.value})).status==="success"?l.success("OTP sent successfully",{autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}):(t.value=!1,clearInterval(o),l.error("Failed to send OTP",{autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}))}catch(r){t.value=!1,clearInterval(o),l.error("Failed to send OTP",{autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}}),g=()=>m(this,null,function*(){if(u.value.length!==6){l.error("Please enter a 6-digit OTP",{autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0});return}if(!n.value){c.push("/login");return}if(p.query.full_name){const r=yield d("mykartavya.controllers.email.register_verify_otp",{email:n.value,otp:u.value,full_name:p.query.full_name});r.status==="success"?(l.success("OTP verified successfully"),window.location.reload()):l.error(r.message)}else try{i.value=!0;const r=yield d("mykartavya.controllers.email.verify_otp",{email:n.value,otp:u.value});i.value=!1,r.status==="success"?(l.success("OTP verified successfully",{autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),setTimeout(()=>{window.location.reload()},2e3)):l.error("Invalid OTP, please try again",{autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(r){i.value=!1,l.error("Failed to verify OTP",{autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}}),T=r=>{g()},B=r=>{u.value=r};return(r,e)=>{const I=w("v-otp-input"),H=w("router-link");return x(),v("div",U,[a("main",z,[e[6]||(e[6]=N('<h1 class="text-[28px] md:text-[33px] font-normal font-poppins">Your Journey of Kindness Starts Here</h1><div class="text-center mt-2"><div class="flex flex-wrap justify-center gap-2 md:gap-4"><button class="border px-4 h-8 items-center bg-white rounded-full text-black border-orange-500 flex gap-1"><img src="'+S+'" alt="Track Icon" class="w-4"><p class="text-[14px] font-normal">Track Your Impact</p></button><button class="border px-4 h-8 items-center bg-white rounded-full text-black border-orange-500 flex gap-1"><img src="'+Y+'" alt="Join Icon" class="w-4"><p class="text-[14px] font-normal">Join Activities Anywhere</p></button><button class="border px-4 h-8 items-center bg-white rounded-full text-black flex gap-1" style="border-color:#F185BB;"><img src="'+E+'" alt="Connect Icon" class="w-4"><p class="text-[14px] font-normal">Connect with a Community</p></button></div></div>',2)),a("div",M,[e[5]||(e[5]=a("h2",{class:"text-[20px] font-medium font-poppins text-gray-900 text-center"},"OTP Verification",-1)),a("p",W,[e[1]||(e[1]=y(" We've shared a 6-digit OTP on ")),a("span",G,_(n.value||"sample@gmail.com"),1)]),a("div",L,[a("div",Q,[b(I,{ref:"otpInput","input-classes":"otp-input",conditionalClass:["one","two","three","four","five","six"],separator:"-","num-inputs":6,value:u.value,"onUpdate:value":e[0]||(e[0]=V=>u.value=V),"should-auto-focus":!0,"should-focus-order":!0,onOnChange:B,onKeyup:R(g,["enter"]),"input-type":"number",onOnComplete:T,placeholder:["*","*","*","*","*","*"]},null,8,["value"])])]),b(H,{to:"/mykarma"},{default:D(()=>[a("button",{onClick:O(g,["prevent"]),class:"w-full flex items-center justify-center h-10 bg-orange-500 text-white py-2 text-[12px] mt-6 rounded-sm hover:bg-orange-600"},[i.value?(x(),v("div",X,e[2]||(e[2]=[a("div",{class:"animate-spin h-full w-full rounded-full border-[2px] flex justify-center items-center border-dotted border-[#fff]"},[a("div",{class:"w-3 h-3 rounded-full border-dashed border-[1px] border-[#fff]"})],-1)]))):(x(),v("p",Z,"VERIFY"))])]),_:1}),a("p",$,[e[4]||(e[4]=y(" Didn't receive? ")),a("a",{href:"#",onClick:O(k,["prevent"]),class:q([{"text-orange-500 hover:text-orange-600":!t.value,"text-gray-400 cursor-not-allowed":t.value},"font-normal text-[14px]"])},[e[3]||(e[3]=y(" Resend OTP ")),t.value?(x(),v("span",ee," ("+_(s.value)+"s) ",1)):A("",!0)],2)])])])])}}};export{le as default};
